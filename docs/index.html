<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8"/>
		<title>Dugesia7</title>
		<link rel="stylesheet" href="style.css"/>
	</head>
	<body>
		<h1>トップページ</h1>
		<div id="se2may">気が向いたときにhtmlとかjs関連のよしなしごとを書き留めたり書き留めなかったりします。</div>
		<div class="note" id="220624">
			<h2>Chromeの拡張機能の説明を読む</h2>
			うちはインストール面倒くさくて<a class="pun" href="https://ja.wikipedia.org/wiki/%E5%88%83%E7%89%A9">Edge</a>使ってるんですが、<a class="pun" href="https://ja.wikipedia.org/wiki/%E3%82%AF%E3%83%AD%E3%83%A0">Chrome</a>の拡張機能の勉強をしていこうと思います。<br>
			挫折しても収穫にはなるはず。<br>
			とりあえず<a href="https://developer.chrome.com/docs/extensions/mv3/">Welcome</a>のページから。
			<ul>
				<li><a href="https://developer.chrome.com/docs/extensions/mv3/overview/">拡張機能 is 何</a>のページを読め</li>
				<li><a href="https://developer.chrome.com/docs/extensions/mv3/getstarted/">蛮族でも分かる拡張機能入門</a>も読め　この二つでだいたい分かる</li>
				<li><a href="https://developer.chrome.com/docs/extensions/mv3/devguide/">諸々のスコープ？についての説明</a>も時間があったら読め　迷った時に役立つ</li>
				<li><a href="https://github.com/GoogleChrome/chrome-extensions-samples">githubにサンプル置いてる</a>から参考にしていいよ</li>
				<li><a href="https://developer.chrome.com/docs/extensions/mv3/faq/">Q&A</a>も置いとくね</li>
			</ul>
			おｋ。<br>
			<ul>
				<li>ちなここに置いてるやつ全部バージョン３用な　バージョン２使いたかったら別のページ見てな</li>
				<li>まあバージョン２あんま使わんほうがええよ</li>
				<li>俺らが作ったやつ以外だと<a href="https://groups.google.com/a/chromium.org/g/chromium-extensions">Google group</a>ってコミュと<a href="https://stackoverflow.com/tags/google-chrome-extension/info">Stack Overflow</a>覗いとくとええよ</li>
			</ul>
			なるほど？Google Group初めて聞いたな　とりあえずまずは上二つ読めばいいのね<br>
			えっと…ページ開いたけど左のリスト見る限り<a href="https://developer.chrome.com/docs/extensions/mv3/overview/">拡張機能is Nani</a>はOverviewってやつの１ページなのかな？<br>
			まあ他のページは後回しでいっか…読めって言われてないし
			<ul>
				<li>拡張機能はブラウザの機能を拡張して便利機能つけたりゲーム作ったりできるやつだよ</li>
				<li><a class="pun" href="https://ja.wikipedia.org/wiki/%E3%83%8F%E3%82%A4%E3%83%86%E3%82%AF">ht</a><a class="pun" href="https://ja.wikipedia.org/wiki/%E6%9E%95">ml</a>と<a class="pun" href="https://ja.wikipedia.org/wiki/%E6%97%A5%E6%9C%AC%E7%B7%8F%E5%90%88%E4%BD%8F%E7%94%9F%E6%B4%BB">js</a>と<a class="pun" href="https://ja.wikipedia.org/wiki/%E3%82%AB%E3%82%B9%E3%82%BF%E3%83%BC%E3%83%89">c</a><a class="pun" href="https://ja.wikipedia.org/wiki/%E3%82%B9%E3%83%A9%E3%82%A4%E3%83%A0">s</a><a class="pun" href="https://ejje.weblio.jp/content/seed">s</a>で作れるよ</li>
				<li>拡張機能UI（拡張機能一覧とかから使える奴）とAPIを使うよ</li>
				<li>manifestというのが必要だよ</li>
				<li>Chromeには拡張機能開発モードみたいなのがついてるからそれ使うといいよ</li>
			</ul>
			サンプル用の<a class="pun" href="https://hwsearch.me/">Hello World</a>的なのもついてましたね。とりあえず試してみましょう。<br>
			まずHelloWorld用のフォルダを作り、そこに必要なファイルを作ったり入れたりしていきます。<br>
			ふーん、manifestはjson形式なのね。（コピペ中）<br>
			見た感じ、拡張機能の名前とか簡単な説明とかを書くファイルらしいです。拡張機能一覧とかに表示されるやつかな？<br>
			あっそういえばさっきバージョン３と２がどうのこうの言いましたが、正確には「マニフェストの」バージョンの３と２の話でした。<br>
			さっきはマニフェストの意味がよくわかってなかったので飛ばしましたが、そうか、これのことかなるほどね<br>
			ちなみにこれに気づいたのはさっきの<a class="pun" href="https://hwsearch.me/">ハロワ</a>のmanifest.jsonに"manifest_version"という欄があって、その値が３だったからです。<br>
			<br>
			あっ読み込むhtmlとかアイコンの設定もここで書くのね。なんで分けて書いたん<br>
			で、用意されてるアイコンをダウンロードして、htmlもコピペしてこれで晴れてHello Worldできるというわけですね（ここのはHello Extensionだったけど）<br>
			アイコンはpngでいいのね。そりゃそうかブラウザに表示されるんだし<br>
			ダウンロードしたアイコンのファイル名がhello_extensions.pngじゃなくてキレそう。マニフェストにそう書いてあるんだから合わせろやリネームせんといけんやろがい<br>
			htmlは↓こんなの。
			<html>
				<body>
					<h1>Hello Extensions</h1>
				</body>
			</html>
			要素がhtmlとbodyとh1しかないどシンプルなやつ。なんとなくでいつも付けてる!DOCTYPE htmlすらない。さすが<a class="pun" href="https://hwsearch.me/">ハロワ</a>というか<a class="pun" href="https://duckduckgo.com/?q=%E3%83%8F%E3%83%AD%E3%82%A8&atb=v319-1&ia=web">ハロエ</a>。<br>
			<br>
			なんかショトカ作るやつもあったけど別に必要ないそうなので飛ばします。<br>
			いよいよテスト。chrome://extensionsとアドレスバーに入れろとのことですがうちはEdgeなので効きません。<br>
			と思ってたけど効いたわ。やってみるもんだね。<br>
			一応もう一つの方法としてブラウザのOmniboxの右にあるメニューからその他のツール→拡張機能というルートでもいけるそう。<br>
			Edgeだとメニュー→拡張機能→拡張機能の管理。<br>
			Chromeのアドレスバー兼検索バーのことをOmniboxというんですね。初めて知りました。<br>
			そういえばVimiumという拡張機能で使ってる検索ボックスがVomnibarという名前だったな…<br>
			で、拡張機能の管理画面から開発者モードに移行し、「拡張機能のパック」。<br>
			<button type="button" class="foldbutton">この辺無駄にぐだついていただけなので伏せます。</button>
			<div class="fold">
				「拡張ルートディレクトリ」にさっきまでのファイルを置いたフォルダを指定し、「拡張機能のパック」。<br>
				<div class="error">指定された拡張機能の秘密キーは既にあります。そのキーを再利用するか、</div>
				最後まで言えや<br>
				えっ確かに秘密キーを入力する欄らしきものがあるけどそれオプションって書いてあるから入れなくてもいいんじゃないの？<br>
				そもそもここでいう秘密キーが何なのかも全くわからんので、こういう時の常としてエラーコード丸々検索します。<br>
				<a href="https://jpdsi.github.io/blog/internet-explorer-microsoft-edge/how-to-deploy-edge-extensions/">いい感じの情報</a>が見つかりました。<br>
				なんでもさっき使ったフォルダの一つ上の階層にpemファイルというものが出来ていて、それをEdgeにドラッグ＆ドロップするといいらしい。<br>
				（実行）あれ？上手く行かないな？ロードされずに中身の文字列が表示されてる。しかもデータのパックにしては小さすぎるというか、<br>
				…これPRIVATE KEYって書いてあるじゃん…<br>
				どう考えてもpemファイルではない。<br>
				おかしいなと思って見返したらデータのパックはCRXファイルという形式で、pemファイルはそもそも秘密鍵だった。<br>
				つまり読み間違い。凡ミスじゃねえか！<br>
				でもあれ？CRXファイルの方はどこにも見当たらないんだが…<br>
				うーん？？？<br>
				（しばらく後）なんか適当に操作したらなんか出来た…<br>
				具体的には「展開して読み込み」でさっきまでのフォルダを読み込んだ。<br>
				えっ？展開って何を展開したん？？？<br>
				もしかして圧縮されてたら展開して読み込み、されてなかったらそのまま読み込みみたいな機能なんか？？？<br>
			</div>
			よく見たら「拡張機能のパック」じゃなくて「展開して読み込み」の方でした。<br>
			圧縮してないんだから展開なんかするわけないという思い込みで見間違いが起こっていた様です。<br>
			「展開して読み込み」から開発フォルダを選択。<br>
			今度こそちゃんと出来ました。<br>
			メニュー→拡張機能→Hello Extensionを押すと用意したHTMLが表示されます。<br>
		</div>
		<script>
			let fobos=document.getElementsByClassName("foldbutton");
			//[...x] coversion to array using spread oprerator
			[...fobos].forEach((fobo)=>{
							fobo.addEventListener("click",function(){
											let folded=this.nextElementSibling;
											folded.style.display= (folded.style.display=="block")?"none":"block";
										})
						});
		</script>
	</body>
</html>
